{% extends "base.html" %}
{% load humanize %}
{% block body_block %}
<main class="main">
    <section class="section-box">
        <div class="breacrumb-cover">
            <div class="container">
              <div class="row">
                <div class="col-lg-6 col-xs-6">
                  <a onclick="backButton()" class="pointer"><i class="fa fa-arrow-left mr-10"></i>Back</a>
                </div>
                <div class="col-lg-6 col-xs-6 text-end">
                  <ul class="breadcrumbs">
                    <li><a class="" href="/">Home</a></li>
                    <li>Walk-in Pricing</li>
                  </ul>
                </div>
              </div>
            </div>
        </div>
    </section>
    <section class="section-box mt-30">
        <div class="container">
            <h3 class="wow animate__animated animate__fadeInUp text-center mb-30">
                Walk-in Pricing Plans</h3>
            
            {% if pack_detail %}
            <div class="text-center mb-4">
                <p class="mb-2">You already have an active plan: <strong>{{ pack_detail.plan_name }}</strong></p>
                <p>Remaining days: <strong>{{ pack_detail.remaining_days }}</strong></p>
                <a href="/walkin-job-form" class="btn btn-default hover-up">Continue to Walk-In Job Form →</a>
            </div>
            {% endif %}
            
            <div class="max-width-price">
                <div class="block-pricing mt-70">
                    <!-- Replace the row with a flex container -->
                    <div class="pricing-flex-container">
                        {% for plan in walkin_plans %}
                        <div class="pricing-flex-item wow animate__animated animate__fadeInUp" data-wow-delay=".1s">
                            <div class="box-pricing-item">
                                <h3>{{plan.plan_name}}</h3>
                                <div class="box-info-price">
                                    {% if plan.price > 0 %}
                                    <span class="text-price color-brand-2">₹ {{plan.price|intcomma}}</span>
                                    <span class="text-month">/{{plan.duration_days}} Days <br>(+18% gst)</span>
                                    {% else %}
                                    <span class="text-price color-brand-2">Free</span>
                                    <span class="text-month">/{{plan.duration_days}} Days</span>
                                    {% endif %}
                                </div>
                                <div class="border-bottom mb-30">
                                    
                                </div>
                                <ul class="list-package-feature" style=" color: #000; font-weight: 650;">
                                    {% if plan.description_points %}
                                        {% for point in plan.description_points %}
                                            <li>{{ point }}</li>
                                        {% endfor %}
                                    {% elif plan.price > 0 %}
                                        <span>₹ {{plan.price|intcomma}}</span> only
                                    {% else %}
                                        <span>Free Plan</span>
                                    {% endif %}
                                </ul>
                                <ul class="list-package-feature" style=" color: #000; font-weight: 650;">
                                    {% for inside_info in plan.amenities %}
                                    <li>{{ inside_info.info }}</li>
                                    {% endfor %}
                                </ul>
                                <form action="/add-subscription" method="post" class="{% if plan.price %} service_form {% endif %}">
                                    {% csrf_token %}
                                    <input hidden type="text" name="plan_id" value="{{plan.id}}">
                                    <input hidden type="text" name="plan" value="School Plan/{{plan.plan_name}}">
                                    <input hidden type="text" name="amount" value="{{plan.price|floatformat:'0'}}">
                                    <input hidden type="text" name="flag" value="1">
                                    {% if pack_detail %}
                                        {% if pack_detail.plan_name == plan.plan_name %}
                                            <div><button class="btn btn-border" type="button">Current Plan</button></div>
                                            <div class="mt-2 text-center">
                                                <p class="job-postings-left">Job postings left: <strong>{{pack_detail.remaining_job_post}}</strong></p>
                                            </div>
                                        {% else %}
                                            <div><button class="btn btn-border" type="submit">Buy Plan</button></div>
                                        {% endif %}
                                    {% else %}
                                        {% if user.is_authenticated %}
                                            <div><button class="btn btn-border" type="submit">Buy Plan</button></div>
                                        {% else %}
                                            <div><a class="btn btn-border" href="/login?next=/school-pricing">Login & Buy</a></div>
                                        {% endif %}
                                    {% endif %}
                                </form>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    {% if pack_detail %}
                    <div class="text-center mt-4">
                        <a href="/walkin-job-form" class="btn btn-default hover-up">Continue to Walk-In Job Form →</a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% if user.is_authenticated and not pack_detail %}
        <div class="text-center mt-4">
            <p class="mb-2">Purchase a plan to continue</p>
        </div>
        {% elif not user.is_authenticated %}
        <div class="text-center mt-4">
            <a href="/login?next=/walkin-pricing" class="btn btn-default hover-up">Login to Purchase a Plan</a>
        </div>
        {% endif %}
    </section>
</main>

<!-- Add CSS for the flexbox layout -->
<style>
    .pricing-flex-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .pricing-flex-item {
        flex: 1 1 250px;
        max-width: 350px;
        min-width: 250px;
    }
    
    /* Make sure the pricing boxes have the same height */
    .box-pricing-item {
        height: 100%;
        display: flex;
        flex-direction: column;
    }
    
    /* Push the button to the bottom */
    .box-pricing-item form {
        margin-top: auto;
    }
    
    @media (max-width: 768px) {
        .pricing-flex-item {
            flex-basis: 100%;
            max-width: 100%;
        }
    }
</style>

<script>
    function backButton() {
        window.history.back();
    }
</script>
{% endblock %}